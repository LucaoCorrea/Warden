@model Warden.Models.CashRegisterModel

@{
    ViewData["Title"] = "Caixa";
    bool isOpen = Model != null && Model.ClosedAt == null;
}

<div class="container py-5">
    <h2 class="mb-4 text-success">💰 Controle de Caixa</h2>

    @if (!isOpen)
    {
        <form asp-action="Open" method="post">
         <div class="alert alert-secondary">
             O caixa será aberto automaticamente com o valor final do último fechamento.
            </div>
            <button type="submit" class="btn btn-success">Abrir Caixa</button>
        </form>
}
    else
    {
        <div class="alert alert-info">
            Caixa aberto desde: <strong>@Model.OpenedAt.ToString("dd/MM/yyyy HH:mm")</strong><br />
            Valor Inicial: <strong>R$ @Model.InitialAmount</strong>
        </div>

        <form asp-action="Close" method="post">
            <div class="mb-3">
                <label class="form-label">Valor Final em Caixa</label>
                <input type="number"
                       step="0.01"
                       name="finalAmount"
                       class="form-control"
                       required
                       value="@Model.InitialAmount.ToString("F2").Replace(",", ".")"
                 readonly />
                 
                <input type="hidden"
                        name="finalAmount"
                        value="@Model.InitialAmount.ToString("F2").Replace(",", ".")" />
             </div>
            <button type="submit" class="btn btn-danger">Fechar Caixa</button>
        </form>
    }
</div>
